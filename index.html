<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç¬é–“åˆ¤æ–­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆå›è»¢åˆ¤æ–­ï¼‰</title>

<style>
body {
  background:#111;
  color:#fff;
  font-family:sans-serif;
  text-align:center;
  margin:0;
}
.hidden { display:none; }
#timer { font-size:22px; margin:10px; }
#center {
  position:relative;
  width:200px;
  height:200px;
  margin:30px auto;
  border-radius:50%;
  background:#222;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:60px;
}
.racket {
   position:absolute;
  width:60px;
  height:60px;
  background:#888;          /* â† æ˜ã‚‹ã */
  border:3px solid #0f9;    /* â† æ ç·šè¿½åŠ  */
  border-radius:12px;
  opacity:1;                /* â† é€æ˜ã‚„ã‚ã‚‹ */
  z-index:2;
}
.racket.active {
  background:#0f9;
}
</style>
</head>

<body>

<div id="start">
  <h1>ğŸ“ å›è»¢ ç¬é–“åˆ¤æ–­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h1>
  <button onclick="startGame()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
</div>

<div id="game" class="hidden">
  <div id="timer">â± 60</div>

  <div id="center">â¬†</div>

  <!-- 8æ–¹å‘ãƒ©ã‚±ãƒƒãƒˆ -->
  <div class="racket" data-dir="0" style="top:-10px; left:70px;"></div>
  <div class="racket" data-dir="1" style="top:10px; right:-10px;"></div>
  <div class="racket" data-dir="2" style="top:70px; right:-10px;"></div>
  <div class="racket" data-dir="3" style="bottom:10px; right:-10px;"></div>
  <div class="racket" data-dir="4" style="bottom:-10px; left:70px;"></div>
  <div class="racket" data-dir="5" style="bottom:10px; left:-10px;"></div>
  <div class="racket" data-dir="6" style="top:70px; left:-10px;"></div>
  <div class="racket" data-dir="7" style="top:10px; left:-10px;"></div>
</div>

<div id="result" class="hidden">
  <h2>çµ‚äº†ï¼</h2>
  <p id="finalScore"></p>
  <button onclick="location.reload()">ã‚‚ã†ä¸€åº¦</button>
</div>

<script>
/* ===== å¤‰æ•° ===== */
let level = 1;
let combo = 0;
let score = 1.0;

let gameTime = 60;
let gameTimer = null;
let questionTimer = null;
let isGameActive = false;

let currentDir = null;

const showTimes = [1200,1000,850,700,600,500,400];
const arrows = ['â¬†','â†—','â¡','â†˜','â¬‡','â†™','â¬…','â†–'];
const rackets = document.querySelectorAll('.racket');

/* ===== é–‹å§‹ ===== */
function startGame(){
  document.getElementById('start').classList.add('hidden');
  document.getElementById('game').classList.remove('hidden');

  isGameActive = true;
  gameTime = 60;
  document.getElementById('timer').textContent = 'â± 60';

  gameTimer = setInterval(()=>{
    gameTime--;
    document.getElementById('timer').textContent = 'â± ' + gameTime;
    if(gameTime <= 0){
      endGame();
    }
  },1000);

  nextQuestion();
}

/* ===== æ¬¡ã®å•é¡Œ ===== */
function nextQuestion(){
  if(!isGameActive) return;

  rackets.forEach(r=>r.classList.remove('active'));

  currentDir = Math.floor(Math.random()*8);
  rackets[currentDir].classList.add('active');
  document.getElementById('center').textContent = arrows[currentDir];

  clearTimeout(questionTimer);
  questionTimer = setTimeout(()=>{
    judge(false);
  }, showTimes[level-1]);
}

/* ===== åˆ¤å®š ===== */
rackets.forEach(r=>{
  r.onclick = ()=>{
    if(!isGameActive) return;
    judge(Number(r.dataset.dir) === currentDir);
  };
});

function judge(correct){
  clearTimeout(questionTimer);

  if(correct){
    combo++;
    if(combo >= 5 && level < 7){
      level++;
      combo = 0;
    }
    score = Number(level + '.' + combo);
  } else {
    combo = 0;
  }

  setTimeout(nextQuestion,300);
}

/* ===== çµ‚äº† ===== */
function endGame(){
  isGameActive = false;
  clearInterval(gameTimer);
  clearTimeout(questionTimer);

  document.getElementById('game').classList.add('hidden');
  document.getElementById('result').classList.remove('hidden');
  document.getElementById('finalScore').textContent =
    'ã‚¹ã‚³ã‚¢ï¼š' + score;
}
</script>

</body>
</html>

