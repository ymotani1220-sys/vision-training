<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å“çƒ å›è»¢åˆ¤æ–­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</title>

<style>
body{
  margin:0;
  background:#111;
  color:#fff;
  font-family:sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

/* ===== å…±é€š ===== */
.screen{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}
.hidden{ display:none; }

/* ===== ã‚¹ã‚¿ãƒ¼ãƒˆ ===== */
#start h1{
  font-size:22px;
  white-space:nowrap;
  margin-bottom:20px;
}
#start button{
  font-size:22px;
  padding:14px 32px;
}

/* ===== ã‚²ãƒ¼ãƒ  ===== */
#game{
  position:relative;
  width:320px;
  height:380px;
}

/* æƒ…å ± */
#info{
  position:absolute;
  top:-90px;
  width:100%;
  text-align:center;
  font-size:18px;
}

/* ===== ä¸­å¤®ãƒœãƒ¼ãƒ« ===== */
#center{
  position:absolute;
  top:160px;
  left:160px;
  width:80px;
  height:80px;
  transform:translate(-50%,-50%);
  border-radius:50%;
  background:#fff;
  z-index:1;
}

/* ===== çŸ¢å°ï¼ˆä¸­å¿ƒå®Œå…¨å›ºå®šï¼‰ ===== */
#arrow{
  position:absolute;
  top:160px;
  left:160px;
  width:0;
  height:0;
  transform-origin:0 20px;
  z-index:2;
}
#arrow::before{
  content:'';
  position:absolute;
  width:6px;
  height:28px;
  background:#f33;
  left:-3px;
  top:-28px;
}
#arrow::after{
  content:'';
  position:absolute;
  top:-42px;
  left:-10px;
  border-left:10px solid transparent;
  border-right:10px solid transparent;
  border-bottom:14px solid #f33;
}

/* ===== åˆ¤å®šï¼ˆãƒ©ã‚±ãƒƒãƒˆå¤–ãƒ»å›ºå®šï¼‰ ===== */
#result{
  position:absolute;
  bottom:0;
  width:100%;
  text-align:center;
  font-size:36px;
  font-weight:bold;
  height:40px;
}
.correct{ color:#0f9; }
.wrong{ color:#f00; }

/* ===== ãƒ©ã‚±ãƒƒãƒˆ ===== */
.spin-btn{
  position:absolute;
  width:50px;
  height:50px;
  border-radius:50%;
  background:#c00;
  border:none;
}
.spin-btn::after{
  content:'';
  position:absolute;
  bottom:-18px;
  left:50%;
  width:12px;
  height:22px;
  background:#caa;
  transform:translateX(-50%);
  border-radius:0 0 6px 6px;
}
.spin-btn.active{ background:#0f9; }
</style>
</head>

<body>

<!-- ã‚¹ã‚¿ãƒ¼ãƒˆ -->
<div id="start" class="screen">
  <h1>ğŸ“ å“çƒå›è»¢åˆ¤æ–­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h1>
  <button onclick="startGame()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
</div>

<!-- ã‚²ãƒ¼ãƒ  -->
<div id="gameScreen" class="screen hidden">
  <div id="game">

    <div id="info">
      Lv <span id="level">1</span>
      ğŸ”¥ <span id="combo">0</span>
      â­ <span id="score">1.0</span>
    </div>

    <div id="center"></div>
    <div id="arrow"></div>

    <div id="result"></div>

  </div>
</div>

<script>
/* ===== è¨­å®š ===== */
const anglesDeg=[-90,-45,0,45,90,135,180,225];
const anglesRad=anglesDeg.map(a=>a*Math.PI/180);
const radius=120, center=160;
const showTimes=[1200,1000,850,700,600,500,400];

const arrow=document.getElementById('arrow');
const result=document.getElementById('result');
const levelEl=document.getElementById('level');
const comboEl=document.getElementById('combo');
const scoreEl=document.getElementById('score');

let rackets=[],correct=0,answered=false,timer=null;
let level=1,combo=0;

/* ===== é–‹å§‹ ===== */
function startGame(){
  document.getElementById('start').classList.add('hidden');
  document.getElementById('gameScreen').classList.remove('hidden');
  nextQuestion();
}

/* ===== ãƒ©ã‚±ãƒƒãƒˆç”Ÿæˆ ===== */
anglesRad.forEach((a,i)=>{
  const b=document.createElement('button');
  b.className='spin-btn';
  b.style.left=center+radius*Math.cos(a)-25+'px';
  b.style.top =center+radius*Math.sin(a)-25+'px';
  b.onclick=()=>answer(i);
  rackets.push(b);
  document.getElementById('game').appendChild(b);
});

/* ===== å‡ºé¡Œ ===== */
function nextQuestion(){
  clearTimeout(timer);
  answered=false;
  result.textContent='';
  result.className='';
  rackets.forEach(r=>r.classList.remove('active'));

  correct=Math.floor(Math.random()*8);
  arrow.style.transform=`rotate(${anglesDeg[correct]}deg)`;

  rackets[correct].classList.add('active');

  timer=setTimeout(()=>{ if(!answered) judge(false); }, showTimes[level-1]);
}

/* ===== å›ç­” ===== */
function answer(i){
  if(answered) return;
  judge(i===correct);
}

/* ===== åˆ¤å®š ===== */
function judge(ok){
  answered=true;
  clearTimeout(timer);
  rackets.forEach(r=>r.classList.remove('active'));

  if(ok){
    result.textContent='ã€‡';
    result.className='correct';
    combo++;
    if(combo>=5 && level<7){ level++; combo=0; }
  }else{
    result.textContent='âœ–';
    result.className='wrong';
    combo=0;
  }
  updateUI();
  setTimeout(nextQuestion,600);
}

/* ===== è¡¨ç¤ºæ›´æ–° ===== */
function updateUI(){
  levelEl.textContent=level;
  comboEl.textContent=combo;
  scoreEl.textContent=`${level}.${combo}`;
}
</script>

</body>
</html>
