<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å“çƒ å›è»¢åˆ¤æ–­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</title>

<style>
body{
  margin:0;
  font-family:sans-serif;
  background:#111;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

/* ç”»é¢å…±é€š */
.screen{
  position:absolute;
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
}

.hidden{
  display:none;
}

/* ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ */
#start{
  background:#111;
}

#start h1{
  margin-bottom:20px;
}

#start button{
  font-size:22px;
  padding:15px 30px;
}

/* ã‚²ãƒ¼ãƒ ç”»é¢ */
#game{
  position:relative;
  width:320px;
  height:320px;
}

/* ä¸Šéƒ¨æƒ…å ± */
#info{
  position:absolute;
  top:-90px;
  width:100%;
  text-align:center;
  font-size:18px;
}

/* ä¸­å¤®ãƒœãƒ¼ãƒ« */
#center{
  position:absolute;
  top:50%;
  left:50%;
  width:80px;
  height:80px;
  transform:translate(-50%,-50%);
  border-radius:50%;
  background:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

/* çŸ¢å° */
#arrow{
  font-size:46px;
  font-weight:900;
  color:#f33;
  text-shadow:
    0 0 4px #000,
    0 0 8px #000;
}

/* åˆ¤å®šï¼ˆãƒœãƒ¼ãƒ«ã¨ãƒ©ã‚±ãƒƒãƒˆã®é–“ï¼‰ */
#result{
  margin-top:8px;
  height:34px;
  font-size:32px;
  font-weight:bold;
  text-shadow:
    0 0 3px #000,
    0 0 6px #000;
}

/* ãƒ©ã‚±ãƒƒãƒˆ */
.spin-btn{
  position:absolute;
  width:50px;
  height:50px;
  border-radius:50%;
  background:#c00;
  border:none;
  transition:0.2s;
}

.spin-btn::after{
  content:'';
  position:absolute;
  bottom:-18px;
  left:50%;
  width:12px;
  height:22px;
  background:#caa;
  transform:translateX(-50%);
  border-radius:0 0 6px 6px;
}

.spin-btn.active{
  background:#0f9;
}
</style>
</head>

<body>

<!-- ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ -->
<div id="start" class="screen">
  <h1>ğŸ“ å“çƒ å›è»¢åˆ¤æ–­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h1>
  <button onclick="startGame()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
</div>

<!-- ã‚²ãƒ¼ãƒ ç”»é¢ -->
<div id="gameScreen" class="screen hidden">
  <div id="game">

    <div id="info">
      Lv <span id="level">1</span>ã€€
      ğŸ”¥ <span id="combo">0</span>ã€€
      â­ <span id="score">1.0</span>
    </div>

    <div id="center">
      <div id="arrow">â†‘</div>
      <div id="result"></div>
    </div>

  </div>
</div>

<script>
/* ===== è¨­å®š ===== */
const anglesDeg = [-90,-45,0,45,90,135,180,225];
const anglesRad = anglesDeg.map(a=>a*Math.PI/180);
const radius = 120;
const centerPos = 160;

const showTimes = [1200,1000,850,700,600,500,400];

const arrow = document.getElementById('arrow');
const result = document.getElementById('result');
const levelEl = document.getElementById('level');
const comboEl = document.getElementById('combo');
const scoreEl = document.getElementById('score');

let rackets = [];
let correctIndex = 0;
let answered = false;
let questionTimer = null;

let level = 1;
let combo = 0;
let maxCombo = 0;

/* ===== ã‚¹ã‚¿ãƒ¼ãƒˆ ===== */
function startGame(){
  document.getElementById('start').classList.add('hidden');
  document.getElementById('gameScreen').classList.remove('hidden');
  nextQuestion();
}

/* ===== ãƒ©ã‚±ãƒƒãƒˆç”Ÿæˆ ===== */
anglesRad.forEach((angle,i)=>{
  const btn = document.createElement('button');
  btn.className = 'spin-btn';

  const x = centerPos + radius * Math.cos(angle) - 25;
  const y = centerPos + radius * Math.sin(angle) - 25;

  btn.style.left = x + 'px';
  btn.style.top = y + 'px';

  btn.onclick = ()=>answer(i);

  rackets.push(btn);
  document.getElementById('game').appendChild(btn);
});

/* ===== å‡ºé¡Œ ===== */
function nextQuestion(){
  clearTimeout(questionTimer);
  answered = false;
  result.textContent = '';

  rackets.forEach(r=>r.classList.remove('active'));

  correctIndex = Math.floor(Math.random()*8);

  arrow.style.transform =
    `rotate(${anglesDeg[correctIndex]+90}deg)`;

  rackets[correctIndex].classList.add('active');

  const showTime = showTimes[level-1];

  questionTimer = setTimeout(()=>{
    if(!answered){
      judge(false);
    }
  }, showTime);
}

/* ===== å›ç­” ===== */
function answer(index){
  if(answered) return;
  judge(index === correctIndex);
}

/* ===== åˆ¤å®š ===== */
function judge(isCorrect){
  answered = true;
  clearTimeout(questionTimer);

  rackets.forEach(r=>r.classList.remove('active'));

  if(isCorrect){
    result.textContent = 'ã€‡';
    result.style.color = '#0f9';
    combo++;
    maxCombo = Math.max(maxCombo, combo);

    if(combo >= 5 && level < 7){
      level++;
      combo = 0;
    }
  }else{
    result.textContent = 'âœ–';
    result.style.color = '#f55';
    combo = 0;
  }

  updateUI();
  setTimeout(nextQuestion, 600);
}

/* ===== è¡¨ç¤ºæ›´æ–° ===== */
function updateUI(){
  levelEl.textContent = level;
  comboEl.textContent = combo;
  scoreEl.textContent = `${level}.${combo}`;
}
</script>

</body>
</html>

