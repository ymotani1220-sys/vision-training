<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>æ‰“ç‚¹åˆ¤æ–­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</title>

<style>
body{
  margin:0;
  background:#111;
  color:#fff;
  font-family:sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

/* ===== å…±é€šã‚¹ã‚¯ãƒªãƒ¼ãƒ³ ===== */
.screen{
  width:100%;
  max-width:420px;
  height:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
}

/* ===== ä¸Šéƒ¨æƒ…å ± ===== */
#info{
  margin-top:10px;
  font-size:20px;
}
#result{
  height:60px;
  font-size:56px;
  font-weight:bold;
  margin-top:6px;
}

/* ===== ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ ===== */
#game{
  position:relative;
  width:100%;
  height:70vh;
  background:#000;
  border-radius:14px;
  margin-top:10px;
  overflow:hidden;
}

/* åºŠ */
#floor{
  position:absolute;
  bottom:0;
  width:100%;
  height:6px;
  background:#444;
}

/* ãƒœãƒ¼ãƒ«ï¼ˆç›´å¾„2å€ï¼‰ */
#ball{
  position:absolute;
  width:44px;
  height:44px;
  border-radius:50%;
  background:orange;
  touch-action:none;
}
</style>
</head>

<body>

<div class="screen">

  <h2 style="margin:8px 0;">ğŸ“ æ‰“ç‚¹åˆ¤æ–­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h2>

  <div id="info">Lv 1</div>
  <div id="result"></div>

  <div id="game">
    <div id="ball"></div>
    <div id="floor"></div>
  </div>

</div>

<script>
/* ===== ãƒ¬ãƒ™ãƒ«è¨­å®š ===== */
const levels = [
  { gravity:0.22, speed:1.4 },
  { gravity:0.26, speed:1.7 },
  { gravity:0.30, speed:2.0 },
  { gravity:0.34, speed:2.3 }
];

const game = document.getElementById("game");
const ball = document.getElementById("ball");
const result = document.getElementById("result");
const info = document.getElementById("info");

let level = 0;
let success = 0;

let x,y,vx,vy;
let bounceCount = 0;
let canTouch = false;
let touched = false;
let active = true;

const BALL_SIZE = 44;

/* ===== åˆæœŸåŒ– ===== */
function resetBall(){
  const h = game.clientHeight;

  x = 20;
  y = h * 0.25;
  vx = levels[level].speed;
  vy = 0;

  bounceCount = 0;
  canTouch = false;
  touched = false;
  active = true;

  ball.style.display = "block";
}

/* ===== ç‰©ç†æ›´æ–° ===== */
function update(){
  if(!active){
    requestAnimationFrame(update);
    return;
  }

  const g = levels[level].gravity;
  const floorY = game.clientHeight - BALL_SIZE;

  x += vx;
  y += vy;
  vy += g;

  if(y >= floorY){
    y = floorY;
    vy = -vy * 0.85;
    bounceCount++;

    if(bounceCount === 1){
      canTouch = true;
    }

    if(bounceCount === 2){
      ball.style.display = "none";
      if(!touched) showResult(false);
    }
  }

  ball.style.left = x + "px";
  ball.style.top  = y + "px";

  requestAnimationFrame(update);
}

/* ===== ãƒœãƒ¼ãƒ«ã‚¿ãƒƒãƒåˆ¤å®š ===== */
ball.addEventListener("pointerdown", ()=>{
  if(!canTouch || touched || !active) return;

  touched = true;
  active = false;
  ball.style.display = "none";
  showResult(true);
});

/* ===== åˆ¤å®šè¡¨ç¤º ===== */
function showResult(ok){
  active = false;

  if(ok){
    result.textContent = "ã€‡";
    result.style.color = "#0f9";
    success++;

    if(success >= 3 && level < levels.length-1){
      level++;
      success = 0;
    }
  }else{
    result.textContent = "âœ–";
    result.style.color = "#f33";
    success = 0;
  }

  info.textContent = `Lv ${level+1}`;

  setTimeout(()=>{
    result.textContent = "";
    resetBall();
    active = true;
  },800);
}

resetBall();
update();
</script>

</body>
</html>

